{"version":3,"sources":["../../../src/js/lib/svgText.js"],"names":["$","window","document","undefined","Plugin","element","options","this","el","extend","defaults","_defaults","_name","pluginName","init","loaderHolderClass","compiledClass","wordClass","spaceClass","orphanWrapClass","originalTextClass","processingClass","convertedClass","failClass","compiledElement","wordElement","spaceElement","orphanWrapElement","originalTextElement","heightBasis","letterCountMap","loader_cache","prototype","me","$el","src","data","addClass","indexOf","css","height","overflow","attr","appendTo","load","resp","status","removeClass","push","generateSText","classes","compiled","createEl","parser","DOMParser","dom","parseFromString","text","body","textContent","words","trim","split","word_count","length","total_letter_count","loader","prefix","zflow","setTimeout","className","forEach","word","i","letters","letter_count","wordEl","zIndex","style","letter","toUpperCase","useLetter","match","charCodeAt","toString","viewBox","def","symbol","find","dimensions","ratio","xmlns","svg","createElNS","setAttribute","setAttributeNS","use","width","appendChild","original","innerText","spacer","space","innerHTML","wrapWords","letter_class","n","html","$compiled","$orphans","children","slice","wrap","first","wrapAll","type","createElement","ns","createElementNS","fn","each","jQuery"],"mappings":"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","file":"svgText.js","sourcesContent":["/*!\n * jQuery lightweight plugin boilerplate\n * Original author: @ajpiano\n * Further changes, comments: @addyosmani\n * Licensed under the MIT license\n */\n\n(function ( $, window, document, undefined ) {\n\n\tvar pluginName = \"svgText\",\n\t\tdefaults = {\n\t\t\tloaderHolderClass: \"stext_loader\",\n\t\t\tcompiledClass: 'st-comp',\n\t\t\twordClass: 'st-word',\n\t\t\tspaceClass: 'st-space',\n\t\t\torphanWrapClass: 'st-orphan',\n\t\t\toriginalTextClass: 'st-original',\n\t\t\tprocessingClass: 'st-processing',\n\t\t\tconvertedClass: 'st-converted',\n\t\t\tfailClass: 'st-failed',\n\t\t\tcompiledElement: 'span',\n\t\t\twordElement: 'span',\n\t\t\tspaceElement: 'span',\n\t\t\torphanWrapElement: 'span',\n\t\t\toriginalTextElement: 'span',\n\t\t\theightBasis: '1.15em',\n\t\t\tletterCountMap: [\n\t\t\t\t8, 9, 11, 14, 16\n\t\t\t]\n\t\t},\n\t\tloader_cache = [];\n\n\t// The actual plugin constructor\n\tfunction Plugin( element, options ) {\n\t\tthis.el = element;\n\n\t\t// jQuery has an extend method that merges the\n\t\t// contents of two or more objects, storing the\n\t\t// result in the first object. The first object\n\t\t// is generally empty because we don't want to alter\n\t\t// the default options for future instances of the plugin\n\t\tthis.options = $.extend( {}, defaults, options) ;\n\n\t\tthis._defaults = defaults;\n\t\tthis._name = pluginName;\n\n\t\tthis.init();\n\t}\n\n\tPlugin.prototype = {\n\n\t\tinit: function() {\n\t\t\t// Place initialization logic here\n\t\t\t// You already have access to the DOM element and\n\t\t\t// the options via the instance, e.g. this.element\n\t\t\t// and this.options\n\t\t\t// you can add more functions like the one below and\n\t\t\t// call them like so: this.yourOtherFunction(this.element, this.options).\n\t\t\t\n\t\t\tvar me = this,\n\t\t\t\t$el = $(this.el),\n\t\t\t\tsrc = $el.data('st-src');\n\n\t\t\t$el.addClass(me.options.processingClass);\n\n\t\t\tif (loader_cache.indexOf(src) < 0) {\n\t\t\t\tvar loader = $('<div class=\"' + this.options.loaderHolderClass +'\">');\n\t\t\t\tloader.css({\n\t\t\t\t\t\theight: 0,\n\t\t\t\t\t\toverflow: 'hidden'\n\t\t\t\t\t})\n\t\t\t\t\t.attr('data-src', src)\n\t\t\t\t\t.appendTo('body')\n\t\t\t\t\t.load(\n\t\t\t\t\t\tsrc,\n\t\t\t\t\t\tfunction(resp, status) {\n\t\t\t\t\t\t\tif (resp == 'error') {\n\t\t\t\t\t\t\t\t$el.removeClass(me.options.processingClass)\n\t\t\t\t\t\t\t\t\t.addClass(me.options.failClass);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\tloader_cache.push(src);\n\t\t\t}\n\t\t\tme.generateSText(me.el);\n\n\t\t},\n\n\t\tgenerateSText: function(el, options) {\n\t\t\tvar me = this,\n\t\t\t\t$el = $(el),\n\t\t\t\tsrc = $el.data('st-src'),\n\t\t\t\tclasses = $el.attr('class'),\n\t\t\t\tcompiled = me.createEl(me.options.compiledElement);\n\n\t\t\t// decode text\n\t\t\tvar parser = new DOMParser,\n\t\t\t\tdom = parser.parseFromString(\n\t\t\t    '<!doctype html><body>' + $el.text(),\n\t\t\t    'text/html');\n\t\t\t    \n\t\t\tvar text = dom.body.textContent,\n\t\t\t\twords = text.trim().split(/[\\s\\t\\n\\r]+/),\n\t\t\t\tword_count = words.length,\n\t\t\t\ttotal_letter_count = 0;\n\n\t\t\t$el.attr('data-wc', word_count);\n\n\t\t\tvar loader = $('.' + me.options.loaderHolderClass + '[data-src=\"' + src + '\"] svg'),\n\t\t\t\tprefix = loader.data('prefix'),\n\t\t\t\tzflow = loader.data('zflow') || '+';\n\n\t\t\tif (\n\t\t\t\t! loader.length ||\n\t\t\t\t! prefix\n\t\t\t) {\n\t\t\t\t// SVG hasn't finished loading, wait it out\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\tme.generateSText(el, me.options);\n\t\t\t\t}, 50);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tcompiled.className = me.options.compiledClass;\n\n\t\t\twords.forEach(function(word, i) {\n\t\t\t\tvar letters = word.split(''),\n\t\t\t\t\tletter_count = letters.length,\n\t\t\t\t\twordEl = me.createEl(me.options.wordElement),\n\t\t\t\t\tzIndex = word_count - i;\n\n\t\t\t\tif (zflow == '+') {\n\t\t\t\t\tzIndex = word_count + i;\n\t\t\t\t}\n\n\t\t\t\ttotal_letter_count += letter_count;\n\n\t\t\t\twordEl.className = me.options.wordClass;\n\t\t\t\twordEl.style.zIndex = zIndex;\n\n\t\t\t\tletters.forEach(function(letter, i) {\n\t\t\t\t\tletter = letter.toUpperCase();\n\n\t\t\t\t\tvar useLetter = letter;\n\n\t\t\t\t\t// if letter is not alphanumeric, use hex code\n\t\t\t\t\tif ( ! letter.match(/[A-Z0-9]/)) {\n\t\t\t\t\t\tuseLetter = '_x' + letter.charCodeAt(0).toString(16).toUpperCase() + '_';\n\t\t\t\t\t}\n\n\t\t\t\t\tvar viewBox = \"0 0 100 100\",\n\t\t\t\t\t\tdef = '#' + prefix + '_' + useLetter,\n\t\t\t\t\t\tsymbol = loader.find(def);\n\t\t\t\t\tif (symbol.length) {\n\t\t\t\t\t\tviewBox = symbol.attr('viewBox');\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tvar dimensions = viewBox.split(' ');\n\t\t\t\t\tif (dimensions.length < 3) {\n\t\t\t\t\t\tthrow \"Invalid viewbox on symbol '\" + letter + \"'\"; \n\t\t\t\t\t}\n\n\t\t\t\t\tvar ratio = (dimensions[2]/dimensions[3]);\n\n\t\t\t\t\tvar xmlns = \"http://www.w3.org/2000/svg\",\n\t\t\t\t\t\tsvg = me.createElNS(xmlns, 'svg');\n\t\t\t\t\tsvg.setAttribute('data-l', letter);\n\t\t\t\t\tsvg.setAttribute('data-w', dimensions[3]);\n\t\t\t\t\tsvg.setAttributeNS(\n\t\t\t\t\t\t\"http://www.w3.org/2000/xmlns/\",\n\t\t\t\t\t\t\"xmlns:xlink\",\n\t\t\t\t\t\t\"http://www.w3.org/1999/xlink\"\n\t\t\t\t\t);\n\n\t\t\t\t\tvar use = me.createElNS(xmlns, 'use');\n\t\t\t\t\tuse.setAttributeNS(\n\t\t\t\t\t\t'http://www.w3.org/1999/xlink',\n\t\t\t\t\t\t'xlink:href',\n\t\t\t\t\t\t'#' + prefix + '_' + useLetter\n\t\t\t\t\t);\n\t\t\t\t\tuse.setAttribute('class', classes);\n\n\t\t\t\t\tvar zIndex = letter_count - i;\n\t\t\t\t\tif (zflow == '+') {\n\t\t\t\t\t\tzIndex = letter_count + i;\n\t\t\t\t\t}\n\n\t\t\t\t\tsvg.style.zIndex = zIndex;\n\t\t\t\t\tsvg.style.width = 'calc( ' + \n\t\t\t\t\t\tme.options.heightBasis + \n\t\t\t\t\t\t' * ' + ratio + ' )';\n\n\t\t\t\t\tsvg.appendChild(use);\n\n\t\t\t\t\twordEl.appendChild(svg);\n\n\t\t\t\t\tif (i === 0) {\n\t\t\t\t\t\twordEl.setAttribute('data-fl', letter);\n\t\t\t\t\t}\n\t\t\t\t\tif (i === letter_count - 1) {\n\t\t\t\t\t\twordEl.setAttribute('data-ll', letter);\n\t\t\t\t\t}\n\n\t\t\t\t});\n\n\t\t\t\tvar original = me.createEl(me.options.originalTextElement);\n\t\t\t\t\toriginal.className = me.options.originalTextClass;\n\t\t\t\t\toriginal.innerText = word;\n\t\t\t\twordEl.appendChild(original);\n\n\t\t\t\tcompiled.appendChild(wordEl);\n\n\t\t\t\tif (i + 1 < word_count) {\n\t\t\t\t\tvar spacer = me.createEl(me.options.spaceElement);\n\t\t\t\t\tspacer.setAttribute('class', me.options.spaceClass);\n\n\t\t\t\t\tvar space = me.createEl(me.options.originalTextElement);\n\t\t\t\t\t\tspace.className = me.options.originalTextClass;\n\t\t\t\t\t\tspace.innerHTML = '&nbsp;';\n\n\t\t\t\t\tspacer.appendChild(space);\n\n\t\t\t\t\tcompiled.appendChild(spacer);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// If last word is short, wrap the last two to\n\t\t\t// prevent ugly orphans\n\t\t\tif (words.length > 2) {\n\t\t\t\tvar last_word = words[words.length-1],\n\t\t\t\t\tlast_letters = last_word.split('');\n\n\t\t\t\tif (last_letters.length < 5) {\n\t\t\t\t\t\n\t\t\t\t\tcompiled = me.wrapWords(compiled);\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// Last word wasn't short, but is the one before it?\n\t\t\t\t\tvar next_last_word = words[words.length-2],\n\t\t\t\t\t\tnext_last_letters = next_last_word.split('');\n\n\t\t\t\t\tif (next_last_letters.length < 5) {\n\t\t\t\t\t\tcompiled = me.wrapWords(compiled);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar letter_class = 0;\n\t\t\tme.options.letterCountMap.forEach(function(n, i) {\n\t\t\t\tif (total_letter_count >= n) {\n\t\t\t\t\tletter_class = i;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t$el\n\t\t\t\t.attr('data-lcl', letter_class)\n\t\t\t\t.attr('data-tlc', total_letter_count)\n\t\t\t\t.html(compiled)\n\t\t\t\t.removeClass(me.options.processingClass)\n\t\t\t\t.addClass(me.options.convertedClass);\n\n\t\t},\n\n\t\twrapWords: function(compiled) {\n\t\t\tvar me = this,\n\t\t\t\t$compiled = $(compiled),\n\t\t\t\t$orphans = $compiled.children().slice(-3),\n\t\t\t\twrap = me.createEl(me.options.orphanWrapElement);\n\n\t\t\twrap.className = me.options.orphanWrapClass;\n\t\t\twrap.setAttribute('data-fl', $orphans.first().data('fl'));\n\n\t\t\t$orphans.wrapAll(wrap);\n\t\t\treturn $compiled;\t\t\t\n\t\t},\n\n\t\tcreateEl: function(type) {\n\t\t\treturn window.document.createElement(type);\n\t\t},\n\n\t\tcreateElNS: function(ns, type) {\n\t\t\treturn window.document.createElementNS(ns, type);\n\t\t}\n\t};\n\n\t// A really lightweight plugin wrapper around the constructor,\n\t// preventing against multiple instantiations\n\t$.fn[pluginName] = function ( options ) {\n\t\treturn this.each(function () {\n\t\t\tif (!$.data(this, \"plugin_\" + pluginName)) {\n\t\t\t\t$.data(this, \"plugin_\" + pluginName,\n\t\t\t\tnew Plugin( this, options ));\n\t\t\t}\n\t\t});\n\t};\n\n})( jQuery, window, document );"]}