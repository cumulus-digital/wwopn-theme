{"version":3,"sources":["../../../src/js/lib/svgText.js"],"names":["$","window","document","undefined","Plugin","element","options","this","el","extend","defaults","_defaults","_name","pluginName","init","loaderHolderClass","compiledClass","wordClass","spaceClass","originalTextClass","processingClass","convertedClass","failClass","compiledElement","wordElement","spaceElement","letterElement","originalTextElement","heightBasis","loader_cache","prototype","me","$el","src","data","addClass","indexOf","css","height","overflow","attr","appendTo","load","resp","status","removeClass","push","generateSText","classes","compiled","createEl","parser","DOMParser","dom","parseFromString","text","body","textContent","words","trim","split","word_count","length","loader","prefix","zflow","setTimeout","className","forEach","word","i","letters","letter_count","wordEl","zIndex","style","letter","toUpperCase","useLetter","match","charCodeAt","toString","viewBox","symbol","find","dimensions","ratio","xmlns","svg","createElNS","setAttribute","setAttributeNS","use","width","appendChild","original","innerText","spacer","html","type","createElement","ns","createElementNS","fn","each","jQuery"],"mappings":"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","file":"svgText.js","sourcesContent":["/*!\n * jQuery lightweight plugin boilerplate\n * Original author: @ajpiano\n * Further changes, comments: @addyosmani\n * Licensed under the MIT license\n */\n\n(function ( $, window, document, undefined ) {\n\n\tvar pluginName = \"svgText\",\n\t\tdefaults = {\n\t\t\tloaderHolderClass: \"stext_loader\",\n\t\t\tcompiledClass: 'st-comp',\n\t\t\twordClass: 'st-word',\n\t\t\tspaceClass: 'st-space',\n\t\t\toriginalTextClass: 'st-original',\n\t\t\tprocessingClass: 'st-processing',\n\t\t\tconvertedClass: 'st-converted',\n\t\t\tfailClass: 'st-failed',\n\t\t\tcompiledElement: 'span',\n\t\t\twordElement: 'span',\n\t\t\tspaceElement: 'span',\n\t\t\tletterElement: 'span',\n\t\t\toriginalTextElement: 'span',\n\t\t\theightBasis: '1.15em',\n\t\t},\n\t\tloader_cache = [];\n\n\t// The actual plugin constructor\n\tfunction Plugin( element, options ) {\n\t\tthis.el = element;\n\n\t\t// jQuery has an extend method that merges the\n\t\t// contents of two or more objects, storing the\n\t\t// result in the first object. The first object\n\t\t// is generally empty because we don't want to alter\n\t\t// the default options for future instances of the plugin\n\t\tthis.options = $.extend( {}, defaults, options) ;\n\n\t\tthis._defaults = defaults;\n\t\tthis._name = pluginName;\n\n\t\tthis.init();\n\t}\n\n\tPlugin.prototype = {\n\n\t\tinit: function() {\n\t\t\t// Place initialization logic here\n\t\t\t// You already have access to the DOM element and\n\t\t\t// the options via the instance, e.g. this.element\n\t\t\t// and this.options\n\t\t\t// you can add more functions like the one below and\n\t\t\t// call them like so: this.yourOtherFunction(this.element, this.options).\n\t\t\t\n\t\t\tvar me = this,\n\t\t\t\t$el = $(this.el),\n\t\t\t\tsrc = $el.data('st-src');\n\n\t\t\t$el.addClass(me.options.processingClass);\n\n\t\t\tif (loader_cache.indexOf(src) < 0) {\n\t\t\t\tvar loader = $('<div class=\"' + this.options.loaderHolderClass +'\">');\n\t\t\t\tloader.css({\n\t\t\t\t\t\theight: 0,\n\t\t\t\t\t\toverflow: 'hidden'\n\t\t\t\t\t})\n\t\t\t\t\t.attr('data-src', src)\n\t\t\t\t\t.appendTo('body')\n\t\t\t\t\t.load(\n\t\t\t\t\t\tsrc,\n\t\t\t\t\t\tfunction(resp, status) {\n\t\t\t\t\t\t\tif (resp == 'error') {\n\t\t\t\t\t\t\t\t$el.removeClass(me.options.processingClass)\n\t\t\t\t\t\t\t\t\t.addClass(me.options.failClass);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\tloader_cache.push(src);\n\t\t\t}\n\t\t\tme.generateSText(me.el);\n\n\t\t},\n\n\t\tgenerateSText: function(el, options) {\n\t\t\tvar me = this,\n\t\t\t\t$el = $(el),\n\t\t\t\tsrc = $el.data('st-src'),\n\t\t\t\tclasses = $el.attr('class'),\n\t\t\t\tcompiled = me.createEl(me.options.compiledElement);\n\n\t\t\t// decode text\n\t\t\tvar parser = new DOMParser,\n\t\t\t\tdom = parser.parseFromString(\n\t\t\t    '<!doctype html><body>' + $el.text(),\n\t\t\t    'text/html');\n\t\t\t    \n\t\t\tvar text = dom.body.textContent,\n\t\t\t\twords = text.trim().split(/[\\s\\t\\n\\r]+/),\n\t\t\t\tword_count = words.length;\n\n\t\t\tvar loader = $('.' + me.options.loaderHolderClass + '[data-src=\"' + src + '\"] svg'),\n\t\t\t\tprefix = loader.data('prefix'),\n\t\t\t\tzflow = loader.data('zflow') || '+';\n\n\t\t\tif (\n\t\t\t\t! loader.length ||\n\t\t\t\t! prefix\n\t\t\t) {\n\t\t\t\t// SVG hasn't finished loading, wait it out\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\tme.generateSText(el, me.options);\n\t\t\t\t}, 50);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tcompiled.className = me.options.compiledClass;\n\n\t\t\twords.forEach(function(word, i) {\n\t\t\t\tvar letters = word.split(''),\n\t\t\t\t\tletter_count = letters.length,\n\t\t\t\t\twordEl = me.createEl(me.options.wordElement),\n\t\t\t\t\tzIndex = word_count - i;\n\n\t\t\t\tif (zflow == '+') {\n\t\t\t\t\tzIndex = word_count + i;\n\t\t\t\t}\n\n\t\t\t\twordEl.className = me.options.wordClass;\n\t\t\t\twordEl.style.zIndex = zIndex;\n\n\t\t\t\tletters.forEach(function(letter, i) {\n\t\t\t\t\tletter = letter.toUpperCase();\n\n\t\t\t\t\tvar useLetter = letter;\n\n\t\t\t\t\t// if letter is not alphanumeric, use hex code\n\t\t\t\t\tif ( ! letter.match(/[A-Z0-9]/)) {\n\t\t\t\t\t\tuseLetter = '_x' + letter.charCodeAt(0).toString(16).toUpperCase() + '_';\n\t\t\t\t\t}\n\n\t\t\t\t\tvar viewBox = \"0 0 100 100\",\n\t\t\t\t\t\tsymbol = loader.find('#' + prefix + '_' + useLetter);\n\t\t\t\t\tif (symbol.length) {\n\t\t\t\t\t\tviewBox = symbol.attr('viewBox');\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tvar dimensions = viewBox.split(' ');\n\t\t\t\t\tif (dimensions.length < 3) {\n\t\t\t\t\t\tthrow \"Invalid viewbox on symbol '\" + letter + \"'\"; \n\t\t\t\t\t}\n\n\t\t\t\t\tvar ratio = (dimensions[2]/dimensions[3]);\n\n\t\t\t\t\tvar xmlns = \"http://www.w3.org/2000/svg\",\n\t\t\t\t\t\tsvg = me.createElNS(xmlns, 'svg');\n\t\t\t\t\tsvg.setAttribute('data-letter', letter);\n\t\t\t\t\tsvg.setAttribute('data-width', dimensions[3]);\n\t\t\t\t\tsvg.setAttributeNS(\n\t\t\t\t\t\t\"http://www.w3.org/2000/xmlns/\",\n\t\t\t\t\t\t\"xmlns:xlink\",\n\t\t\t\t\t\t\"http://www.w3.org/1999/xlink\"\n\t\t\t\t\t);\n\n\t\t\t\t\tvar use = me.createElNS(xmlns, 'use');\n\t\t\t\t\tuse.setAttributeNS(\n\t\t\t\t\t\t'http://www.w3.org/1999/xlink',\n\t\t\t\t\t\t'xlink:href',\n\t\t\t\t\t\t'#' + prefix + '_' + useLetter\n\t\t\t\t\t);\n\t\t\t\t\tuse.setAttribute('class', classes);\n\n\t\t\t\t\tvar zIndex = letter_count - i;\n\t\t\t\t\tif (zflow == '+') {\n\t\t\t\t\t\tzIndex = letter_count + i;\n\t\t\t\t\t}\n\n\t\t\t\t\tsvg.style.zIndex = zIndex;\n\t\t\t\t\tsvg.style.width = 'calc( ' + \n\t\t\t\t\t\tme.options.heightBasis + \n\t\t\t\t\t\t' * ' + ratio + ' )';\n\n\t\t\t\t\tsvg.appendChild(use);\n\n\t\t\t\t\twordEl.appendChild(svg);\n\n\t\t\t\t\tif (i === 0) {\n\t\t\t\t\t\twordEl.setAttribute('data-first_letter', letter);\n\t\t\t\t\t}\n\t\t\t\t\tif (i === letter_count - 1) {\n\t\t\t\t\t\twordEl.setAttribute('data-last_letter', letter);\n\t\t\t\t\t}\n\n\t\t\t\t});\n\n\t\t\t\tvar original = me.createEl(me.options.originalTextElement);\n\t\t\t\t\toriginal.className = me.options.originalTextClass;\n\t\t\t\t\toriginal.innerText = word;\n\t\t\t\twordEl.appendChild(original);\n\n\t\t\t\tcompiled.appendChild(wordEl);\n\n\t\t\t\tif (i + 1 < word_count) {\n\t\t\t\t\tvar spacer = me.createEl(me.options.spaceElement);\n\t\t\t\t\tspacer.setAttribute('class', me.options.spaceClass);\n\t\t\t\t\tcompiled.appendChild(spacer);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t$el\n\t\t\t\t.html(compiled)\n\t\t\t\t.removeClass(me.options.processingClass)\n\t\t\t\t.addClass(me.options.convertedClass);\n\n\t\t},\n\n\t\tcreateEl: function(type) {\n\t\t\treturn window.document.createElement(type);\n\t\t},\n\n\t\tcreateElNS: function(ns, type) {\n\t\t\treturn window.document.createElementNS(ns, type);\n\t\t}\n\t};\n\n\t// A really lightweight plugin wrapper around the constructor,\n\t// preventing against multiple instantiations\n\t$.fn[pluginName] = function ( options ) {\n\t\treturn this.each(function () {\n\t\t\tif (!$.data(this, \"plugin_\" + pluginName)) {\n\t\t\t\t$.data(this, \"plugin_\" + pluginName,\n\t\t\t\tnew Plugin( this, options ));\n\t\t\t}\n\t\t});\n\t};\n\n})( jQuery, window, document );"]}